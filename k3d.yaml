# Copyright © 2020 Vertigo Tecnologia. All rights reserved.
# Licensed under the  Apache License, Version 2.0. See LICENSE file in the project root for full license information.
kong:
  ingressController:
    enabled: true
  admin:
    enabled: true
    http:
      enabled: true
    type: ClusterIP
    tls:
      enabled: false
  proxy:
    type: NodePort
    http:
      enabled: true
      nodePort: 32080

konga:
  enabled: true
  config:
    # node_env: production
    node_env: development
    ssl_key_path: ""
    ssl_crt_path: ""
    db_adapter: postgres
    # db_adapter: localDiskDb
    log_level: debug
    token_secret: ""
    konga_node_data: "/opt/config/konga_node.data"
    konga_user_data: "/opt/config/konga_user.data"
    db_host: vtg-ipaas-postgresql
    db_port: 5432
    db_user: konga
    db_password: konga123
    db_database: konga
    db_pg_schema: public
    # db_uri: postgresql://[user[:password]@][netloc][:port][/dbname]
    db_uri: postgresql://konga:konga123@vtg-ipaas-postgresql/konga
    # konga_hook_timeout: 60000
  # CUIDADO COM A INDENTACAO NOS EXTRAS
  extraVolumes:
    - name: config
      configMap:
        name: vtg-ipaas-konga-init
        items:
          - key: konga_node.data
            path: konga_node.data
            mode: 292 # 0444
          - key: konga_user.data
            path: konga_user.data
            mode: 292 # 0444
  extraVolumeMounts:
    - name: config
      mountPath: /opt/config
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: kong # so há um ingress controller (kong)
    hosts:
      - host: konga.localdomain
        paths: ["/"]

postgresql:
  enabled: true
  postgresqlPostgresPassword: pgadmin123
  postgresqlUsername: konga
  postgresqlPassword: konga123
  postgresqlDatabase: konga

pgadmin:
  enabled: false
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
      kubernetes.io/tls-acme: "true"
    hosts:
      - host: pgadmin.api.vertigo.com.br
        paths: ["/"]
    tls:
      - hosts:
          - pgadmin.api.vertigo.com.br
        secretName: pgadmin-cert
  persistence:
    enabled: true
  # env:
  #   username: "pgadmin@aqui.com"
  #   password: SuperSecret

openfaas:
  enabled: true
  functionNamespace: openfaas-fn
  generateBasicAuth: true
  operator:
    create: true
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: kong
    hosts:
      - host: gateway.ipaas.localdomain
        serviceName: gateway
        servicePort: 8080
        path: /
  prometheus:
    create: false
  alertmanager:
    create: false

# TODO: permitir alternativa single node com redis comum
redis-ha:
  enabled: false
